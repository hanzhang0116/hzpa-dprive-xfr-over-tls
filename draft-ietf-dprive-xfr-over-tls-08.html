<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>DNS Zone Transfer-over-TLS</title>
<meta content="Willem Toorop" name="author">
<meta content="Sara Dickinson" name="author">
<meta content="Shivan Sahib" name="author">
<meta content="Pallavi Aras" name="author">
<meta content="Allison Mankin" name="author">
<meta content="
       DNS zone transfers are transmitted in clear text, which gives attackers the
opportunity to collect the content of a zone by eavesdropping on network
connections. The DNS Transaction Signature (TSIG) mechanism is specified to
restrict direct zone transfer to authorized clients only, but it does not add
confidentiality. This document specifies the use of TLS, rather than clear text, to
prevent zone content collection via passive monitoring of zone transfers:
XFR-over-TLS (XoT). Additionally, this specification updates RFC1995,
RFC5936 and RFC7766.
 
    " name="description">
<meta content="xml2rfc 3.5.0" name="generator">
<meta content="DNS" name="keyword">
<meta content="operations" name="keyword">
<meta content="privacy" name="keyword">
<meta content="draft-ietf-dprive-xfr-over-tls-07" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.9.0
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.2
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.0
    setuptools 50.3.2
    six 1.15.0
-->
<link href="draft-ietf-dprive-xfr-over-tls.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">XFR-over-TLS</td>
<td class="right">February 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Toorop, et al.</td>
<td class="center">Expires 20 August 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">dprive</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dprive-xfr-over-tls-07</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc1995" class="eref">1995</a>, <a href="https://www.rfc-editor.org/rfc/rfc5936" class="eref">5936</a>, <a href="https://www.rfc-editor.org/rfc/rfc7766" class="eref">7766</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-02-16" class="published">16 February 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-08-20">20 August 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Toorop</div>
<div class="org">NLnet Labs</div>
</div>
<div class="author">
      <div class="author-name">S. Dickinson</div>
<div class="org">Sinodun IT</div>
</div>
<div class="author">
      <div class="author-name">S. Sahib</div>
<div class="org">Salesforce</div>
</div>
<div class="author">
      <div class="author-name">P. Aras</div>
<div class="org">Salesforce</div>
</div>
<div class="author">
      <div class="author-name">A. Mankin</div>
<div class="org">Salesforce</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">DNS Zone Transfer-over-TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">DNS zone transfers are transmitted in clear text, which gives attackers the
opportunity to collect the content of a zone by eavesdropping on network
connections. The DNS Transaction Signature (TSIG) mechanism is specified to
restrict direct zone transfer to authorized clients only, but it does not add
confidentiality. This document specifies the use of TLS, rather than clear text, to
prevent zone content collection via passive monitoring of zone transfers:
XFR-over-TLS (XoT). Additionally, this specification updates RFC1995,
RFC5936 and RFC7766.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 August 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-document-work-via-github" class="xref">Document work via GitHub</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-use-cases-for-xfr-over-tls" class="xref">Use Cases for XFR-over-TLS</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-threat-model" class="xref">Threat model</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-connection-and-data-flows-i" class="xref">Connection and Data Flows in Existing XFR Mechanisms</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-axfr-mechanism" class="xref">AXFR Mechanism</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ixfr-mechanism" class="xref">IXFR Mechanism</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-data-leakage-of-notify-and-" class="xref">Data Leakage of NOTIFY and SOA Message Exchanges</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-notify" class="xref">NOTIFY</a><a href="#section-toc.1-1.5.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-soa" class="xref">SOA</a><a href="#section-toc.1-1.5.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-updates-to-existing-specifi" class="xref">Updates to existing specifications</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-update-to-rfc1995-for-ixfr-" class="xref">Update to RFC1995 for IXFR-over-TCP</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-update-to-rfc5936-for-axfr-" class="xref">Update to RFC5936 for AXFR-over-TCP</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-updates-to-rfc1995-and-rfc5" class="xref">Updates to RFC1995 and RFC5936 for XFR-over-TCP</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-connection-reuse" class="xref">Connection reuse</a><a href="#section-toc.1-1.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-axfrs-and-ixfrs-on-the-same" class="xref">AXFRs and IXFRs on the same connection</a><a href="#section-toc.1-1.6.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="xref">6.3.3</a>.  <a href="#name-xfr-limits" class="xref">XFR limits</a><a href="#section-toc.1-1.6.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.4">
                    <p id="section-toc.1-1.6.2.3.2.4.1"><a href="#section-6.3.4" class="xref">6.3.4</a>.  <a href="#name-the-edns-tcp-keepalive-edns" class="xref">The edns-tcp-keepalive EDNS0 Option</a><a href="#section-toc.1-1.6.2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.5">
                    <p id="section-toc.1-1.6.2.3.2.5.1"><a href="#section-6.3.5" class="xref">6.3.5</a>.  <a href="#name-backwards-compatibility" class="xref">Backwards compatibility</a><a href="#section-toc.1-1.6.2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-update-to-rfc7766" class="xref">Update to RFC7766</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-xot-specification" class="xref">XoT specification</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-tls-versions" class="xref">TLS versions</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-port-selection" class="xref">Port selection</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-high-level-xot-descriptions" class="xref">High level XoT descriptions</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-xot-transfers" class="xref">XoT transfers</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-xot-connections" class="xref">XoT connections</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-xot-vs-adot" class="xref">XoT vs ADoT</a><a href="#section-toc.1-1.7.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-response-rcodes" class="xref">Response RCODES</a><a href="#section-toc.1-1.7.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-axot-specifics" class="xref">AXoT specifics</a><a href="#section-toc.1-1.7.2.8.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.8.2.1">
                    <p id="section-toc.1-1.7.2.8.2.1.1"><a href="#section-7.8.1" class="xref">7.8.1</a>.  <a href="#name-padding-axot-responses" class="xref">Padding AXoT responses</a><a href="#section-toc.1-1.7.2.8.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-ixot-specifics" class="xref">IXoT specifics</a><a href="#section-toc.1-1.7.2.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.9.2.1">
                    <p id="section-toc.1-1.7.2.9.2.1.1"><a href="#section-7.9.1" class="xref">7.9.1</a>.  <a href="#name-condensation-of-responses" class="xref">Condensation of responses</a><a href="#section-toc.1-1.7.2.9.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.9.2.2">
                    <p id="section-toc.1-1.7.2.9.2.2.1"><a href="#section-7.9.2" class="xref">7.9.2</a>.  <a href="#name-fallback-to-axfr" class="xref">Fallback to AXFR</a><a href="#section-toc.1-1.7.2.9.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.9.2.3">
                    <p id="section-toc.1-1.7.2.9.2.3.1"><a href="#section-7.9.3" class="xref">7.9.3</a>.  <a href="#name-padding-of-ixot-responses" class="xref">Padding of IXoT responses</a><a href="#section-toc.1-1.7.2.9.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="xref">7.10</a>. <a href="#name-name-compression-and-maximu" class="xref">Name compression and maximum payload sizes</a><a href="#section-toc.1-1.7.2.10.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-multi-primary-configuration" class="xref">Multi-primary Configurations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-authentication-mechanisms" class="xref">Authentication mechanisms</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-tsig" class="xref">TSIG</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-sig0" class="xref">SIG(0)</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-tls" class="xref">TLS</a><a href="#section-toc.1-1.9.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="xref">9.3.1</a>.  <a href="#name-opportunistic-tls" class="xref">Opportunistic TLS</a><a href="#section-toc.1-1.9.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-9.3.2" class="xref">9.3.2</a>.  <a href="#name-strict-tls" class="xref">Strict TLS</a><a href="#section-toc.1-1.9.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3.2.3">
                    <p id="section-toc.1-1.9.2.3.2.3.1"><a href="#section-9.3.3" class="xref">9.3.3</a>.  <a href="#name-mutual-tls" class="xref">Mutual TLS</a><a href="#section-toc.1-1.9.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-ip-based-acl-on-the-primary" class="xref">IP Based ACL on the Primary</a><a href="#section-toc.1-1.9.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-zonemd" class="xref">ZONEMD</a><a href="#section-toc.1-1.9.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-xot-authentication" class="xref">XoT authentication</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-policies-for-both-axot-and-" class="xref">Policies for Both AXoT and IXoT</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-implementation-consideratio" class="xref">Implementation Considerations</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-contributors" class="xref">Contributors</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-changelog" class="xref">Changelog</a><a href="#section-toc.1-1.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="xref">19</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.19.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#section-19.1" class="xref">19.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.19.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#section-19.2" class="xref">19.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.19.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-xot-server-connection-handl" class="xref">XoT server connection handling</a><a href="#section-toc.1-1.20.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-only-listen-on-tls-on-a-spe" class="xref">Only listen on TLS on a specific IP address</a><a href="#section-toc.1-1.20.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-client-specific-tls-accepta" class="xref">Client specific TLS acceptance</a><a href="#section-toc.1-1.20.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.20.2.3">
                <p id="section-toc.1-1.20.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-sni-based-tls-acceptance" class="xref">SNI based TLS acceptance</a><a href="#section-toc.1-1.20.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.20.2.4">
                <p id="section-toc.1-1.20.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-tls-specific-response-polic" class="xref">TLS specific response policies</a><a href="#section-toc.1-1.20.2.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.20.2.4.2.1">
                    <p id="section-toc.1-1.20.2.4.2.1.1"><a href="#section-a.4.1" class="xref">A.4.1</a>.  <a href="#name-sni-based-response-policies" class="xref">SNI based response policies</a><a href="#section-toc.1-1.20.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.21.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DNS has a number of privacy vulnerabilities, as discussed in detail in
<span>[<a href="#RFC7626" class="xref">RFC7626</a>]</span>. Stub client to recursive resolver query privacy has received the
most attention to date, with standards track documents for both DNS-over-TLS
(DoT) <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span> and DNS-over-HTTPS (DoH) <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>, and a proposal for
DNS-over-QUIC <span>[<a href="#I-D.ietf-dprive-dnsoquic" class="xref">I-D.ietf-dprive-dnsoquic</a>]</span>. There is ongoing work on DNS privacy
requirements for exchanges between recursive resolvers and authoritative
servers <span>[<a href="#I-D.ietf-dprive-phase2-requirements" class="xref">I-D.ietf-dprive-phase2-requirements</a>]</span> and some suggestions for how
signaling of DoT support by authoritatives might work, e.g.,
<span>[<a href="#I-D.vandijk-dprive-ds-dot-signal-and-pin" class="xref">I-D.vandijk-dprive-ds-dot-signal-and-pin</a>]</span>. However there is currently no RFC
that specifically defines recursive to authoritative DNS-over-TLS (ADoT).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><span>[<a href="#RFC7626" class="xref">RFC7626</a>]</span> established that stub client DNS query
transactions are not public and needed protection, but on zone transfer
<span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> it says only:<a href="#section-1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-1-3">
<pre>
"Privacy risks for the holder of a zone (the risk that someone
gets the data) are discussed in [RFC5936] and [RFC5155]."
</pre><a href="#section-1-3" class="pilcrow">¶</a>
</div>
<p id="section-1-4">In what way is exposing the full contents of a zone a privacy risk? The
contents of the zone could include information such as names of persons used in
names of hosts. Best practice is not to use personal information for domain
names, but many such domain names exist. The contents of the zone could also
include references to locations that allow inference about location information
of the individuals associated with the zone's organization. It could also
include references to other organizations. Examples of this could be:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">Person-laptop.example.org<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.2">MX-for-Location.example.org<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.3">Service-tenant-from-another-org.example.org<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-6">There may also be regulatory, policy or other reasons why the zone contents in
full must be treated as private.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Neither of the RFCs mentioned in <span>[<a href="#RFC7626" class="xref">RFC7626</a>]</span>
contemplates the risk that someone gets the data through eavesdropping on
network connections, only via enumeration or unauthorized transfer as described
in the following paragraphs.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Zone enumeration is trivially possible for DNSSEC zones which use NSEC; i.e.
queries for the authenticated denial of existences records allow a client to
walk through the entire zone contents. <span>[<a href="#RFC5155" class="xref">RFC5155</a>]</span> specifies NSEC3, a mechanism
to provide measures against zone enumeration for DNSSEC signed zones (a goal
was to make it as hard to enumerate an DNSSEC signed zone as an unsigned zone).
Whilst this is widely used, zone walking is now possible with NSEC3 due to
crypto-breaking advances. This has prompted further work on an alternative
mechanism for DNSSEC authenticated denial of existence - NSEC5
<span>[<a href="#I-D.vcelak-nsec5" class="xref">I-D.vcelak-nsec5</a>]</span> - however questions remain over the practicality of this
mechanism.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9"><span>[<a href="#RFC5155" class="xref">RFC5155</a>]</span> does not address data obtained outside zone enumeration (nor does
<span>[<a href="#I-D.vcelak-nsec5" class="xref">I-D.vcelak-nsec5</a>]</span>). Preventing eavesdropping of zone transfers (this draft)
is orthogonal to preventing zone enumeration, though they aim to protect the
same information.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10"><span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> specifies using TSIG <span>[<a href="#RFC2845" class="xref">RFC2845</a>]</span> for authorization of the clients
of a zone transfer and for data integrity, but does not express any need for
confidentiality, and TSIG does not offer encryption. Some operators use SSH
tunneling or IPSec to encrypt the transfer data.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">Section 8 of the NIST guide on 'Secure Domain Name System (DNS) Deployment'
<span>[<a href="#nist-guide" class="xref">nist-guide</a>]</span> discusses restricting access for zone transfers using ACLs and TSIG
in more detail. It is noted that in all the common open source implementations
such ACLs are applied on a per query basis. Since requests typically occur on
TCP connections authoritatives must cater for accepting any TCP connection and
then handling the authentication of each XFR request individually.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">Because both AXFR and IXFR zone transfers are typically carried out over TCP
from authoritative DNS protocol implementations, encrypting zone transfers
using TLS, based closely on DoT <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>, seems like a simple step forward.
This document specifies how to use TLS as a transport to prevent zone
collection from zone transfers.<a href="#section-1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-work-via-github">
<section id="section-2">
      <h2 id="name-document-work-via-github">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-document-work-via-github" class="section-name selfRef">Document work via GitHub</a>
      </h2>
<p id="section-2-1">[THIS SECTION TO BE REMOVED BEFORE PUBLICATION] The Github repository for this
document is at <span><a href="https://github.com/hanzhang0116/hzpa-dprive-xfr-over-tls">https://github.com/hanzhang0116/hzpa-dprive-xfr-over-tls</a></span>.
Proposed text and editorial changes are very much welcomed there, but any
functional changes should always first be discussed on the IETF DPRIVE WG (dns-privacy) mailing list.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> and
<span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Privacy terminology is as described in Section 3 of <span>[<a href="#RFC6973" class="xref">RFC6973</a>]</span>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Note that in this document we choose to use the terms 'primary' and 'secondary'
for two servers engaged in zone transfers.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">DNS terminology is as described in <span>[<a href="#RFC8499" class="xref">RFC8499</a>]</span>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">DoT: DNS-over-TLS as specified in <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span><a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">XFR-over-TCP: Used to mean both IXFR-over-TCP <span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> and AXFR-over-TCP <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">XoT: Generic XFR-over-TLS mechanisms as specified in this document<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">AXoT: AXFR-over-TLS<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">IXoT: IXFR over-TLS<a href="#section-3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases-for-xfrovertls">
<section id="section-4">
      <h2 id="name-use-cases-for-xfr-over-tls">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-use-cases-for-xfr-over-tls" class="section-name selfRef">Use Cases for XFR-over-TLS</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-4-1.1">Confidentiality. Clearly using an encrypted transport for zone transfers will
defeat zone content leakage that can occur via passive surveillance.<a href="#section-4-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-1.2">Authentication. Use of single or mutual TLS (mTLS) authentication (in combination
with ACLs) can complement and potentially be an alternative to TSIG.<a href="#section-4-1.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-1.3">Performance. Existing AXFR and IXFR mechanisms have the burden of backwards
compatibility with older implementations based on the original specifications
in <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> and <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>. For example, some older AXFR servers don't
support using a TCP connection for multiple AXFR sessions or XFRs of different
zones because they have not been updated to follow the guidance in <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>.
Any implementation of XFR-over-TLS (XoT) would obviously be required to
implement optimized and interoperable transfers as described in <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>,
e.g., transfer of multiple zones over one connection.<a href="#section-4-1.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-1.4">Performance. Current usage of TCP for IXFR is sub-optimal in some cases i.e.
connections are frequently closed after a single IXFR.<a href="#section-4-1.4" class="pilcrow">¶</a>
</li>
      </ul>
<div id="threat-model">
<section id="section-4.1">
        <h3 id="name-threat-model">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-threat-model" class="section-name selfRef">Threat model</a>
        </h3>
<p id="section-4.1-1">The threat model considered here is one where the current contents and size of the zone are considered
sensitive and should be protected during transfer.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The threat model does not, however, consider the existence of a zone, the act of
zone transfer between two entities, nor the identities of the nameservers
hosting a zone (including both those acting as hidden primaries/secondaries
or directly serving the zone) as sensitive information. The proposed mechanisms
does not attempt to obscure such information. The reasons for this include:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">much of this information can be obtained by various methods including active scanning of the DNS<a href="#section-4.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.2">an attacker who can monitor network traffic can relatively easily infer relations between
nameservers simply from traffic patterns, even when some or all of the traffic is encrypted<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-4">It is noted that simply using XoT will indicate a desire by the zone owner that the contents of the zone
remain confidential and so could be subject to blocking (e.g. via blocking of port 853) if an attacker had
such capabilities. However this threat is likely true of any such mechanism that attempts to encrypt data
passed between nameservers e.g. IPsec.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="connection-and-data-flows-in-existing-xfr-mechanisms">
<section id="section-5">
      <h2 id="name-connection-and-data-flows-i">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-connection-and-data-flows-i" class="section-name selfRef">Connection and Data Flows in Existing XFR Mechanisms</a>
      </h2>
<p id="section-5-1">The original specification for zone transfers in <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> and <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> was
based on a polling mechanism: a secondary performed a periodic SOA query (based
on the refresh timer) to determine if an AXFR was required.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"><span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> and <span>[<a href="#RFC1996" class="xref">RFC1996</a>]</span> introduced the concepts of IXFR and NOTIFY
respectively, to provide for prompt propagation of zone updates. This has
largely replaced AXFR where possible, particularly for dynamically updated
zones.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"><span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> subsequently redefined the specification of AXFR to improve
performance and interoperability.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">In this document we use the term "XFR mechanism" to describe the entire set of
message exchanges between a secondary and a primary that concludes in a
successful AXFR or IXFR request/response. This set may or may not include<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">NOTIFY messages<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.2">SOA queries<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.3">Fallback from IXFR to AXFR<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.4">Fallback from IXFR-over-UDP to IXFR-over-TCP<a href="#section-5-5.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-6">The term is used to encompasses the range of permutations that are possible and
is useful to distinguish the 'XFR mechanism' from a single XFR
request/response exchange.<a href="#section-5-6" class="pilcrow">¶</a></p>
<div id="axfr-mechanism">
<section id="section-5.1">
        <h3 id="name-axfr-mechanism">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-axfr-mechanism" class="section-name selfRef">AXFR Mechanism</a>
        </h3>
<p id="section-5.1-1">The figure below provides an outline of an AXFR mechanism including NOTIFYs.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.1-2">
<pre>
   Secondary                            Primary

       |              NOTIFY               |
       | &lt;-------------------------------- |  UDP
       | --------------------------------&gt; |
       |          NOTIFY Response          |
       |                                   |
       |                                   |
       |            SOA Request            |
       | --------------------------------&gt; |  UDP (or part of
       | &lt;-------------------------------- |  a TCP session)
       |           SOA Response            |
       |                                   |
       |                                   |
       |                                   |
       |            AXFR Request           | ---
       | --------------------------------&gt; |   |
       | &lt;-------------------------------- |   |
       |          AXFR Response 1          |   |
       |             (Zone data)           |   |
       |                                   |   |
       | &lt;-------------------------------- |   | TCP
       |          AXFR Response 2          |   | Session
       |             (Zone data)           |   |
       |                                   |   |
       | &lt;-------------------------------- |   |
       |          AXFR Response 3          |   |
       |             (Zone data)           | ---
       |                                   |

              Figure 1. AXFR Mechanism

</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-5.1-3">
<li id="section-5.1-3.1">An AXFR is often (but not always) preceded by a NOTIFY (over UDP) from the
primary to the secondary. A secondary may also initiate an AXFR based on a
refresh timer or scheduled/triggered zone maintenance.<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-3.2">The secondary will normally (but not always) make a SOA query to the primary
to obtain the serial number of the zone held by the primary.<a href="#section-5.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-3.3">If the primary serial is higher than the secondaries serial (using Serial
Number Arithmetic <span>[<a href="#RFC1982" class="xref">RFC1982</a>]</span>), the secondary makes an AXFR request (over TCP)
to the primary after which the AXFR data flows in one or more AXFR responses on
the TCP connection. <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> defines this specific step as an 'AXFR session'
i.e. as an AXFR query message and the sequence of AXFR response messages
returned for it.<a href="#section-5.1-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.1-4"><span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> re-specified AXFR providing additional guidance beyond that provided
in <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> and <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> and importantly specified that AXFR must use TCP
as the transport protocol.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Additionally, sections 4.1, 4.1.1 and 4.1.2 of <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> provide improved
guidance for AXFR clients and servers with regard to re-use of TCP connections
for multiple AXFRs and AXFRs of different zones. However <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> was
constrained by having to be backwards compatible with some very early basic
implementations of AXFR. For example, it outlines that the SOA query can also
happen on this connection. However, this can cause interoperability problems
with older implementations that support only the trivial case of one AXFR per
connection.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ixfr-mechanism">
<section id="section-5.2">
        <h3 id="name-ixfr-mechanism">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ixfr-mechanism" class="section-name selfRef">IXFR Mechanism</a>
        </h3>
<p id="section-5.2-1">The figure below provides an outline of the IXFR mechanism including NOTIFYs.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.2-2">
<pre>
   Secondary                            Primary

       |              NOTIFY               |
       | &lt;-------------------------------- |  UDP
       | --------------------------------&gt; |
       |          NOTIFY Response          |
       |                                   |
       |                                   |
       |            SOA Request            |
       | --------------------------------&gt; |  UDP or TCP
       | &lt;-------------------------------- |
       |           SOA Response            |
       |                                   |
       |                                   |
       |                                   |
       |            IXFR Request           |
       | --------------------------------&gt; |  UDP or TCP
       | &lt;-------------------------------- |
       |            IXFR Response          |
       |             (Zone data)           |
       |                                   |
       |                                   | ---
       |            IXFR Request           |    |
       | --------------------------------&gt; |    | Retry over
       | &lt;-------------------------------- |    | TCP if
       |            IXFR Response          |    | required
       |             (Zone data)           | ---

              Figure 1. IXFR Mechanism

</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-5.2-3">
<li id="section-5.2-3.1">An IXFR is normally (but not always) preceded by a NOTIFY (over UDP) from the
primary to the secondary. A secondary may also initiate an IXFR based on a
refresh timer or scheduled/triggered zone maintenance.<a href="#section-5.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-3.2">The secondary will normally (but not always) make a SOA query to the primary
to obtain the serial number of the zone held by the primary.<a href="#section-5.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-3.3">If the primary serial is higher than the secondaries serial (using Serial
Number Arithmetic <span>[<a href="#RFC1982" class="xref">RFC1982</a>]</span>), the secondary makes an IXFR request to the
primary after the primary sends an IXFR response.<a href="#section-5.2-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.2-4"><span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> specifies that Incremental Transfer may use UDP if the entire IXFR
response can be contained in a single DNS packet, otherwise, TCP is used. In
fact it says:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.2-5">
<pre>
"Thus, a client should first make an IXFR query using UDP."
</pre><a href="#section-5.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2-6">So there may be a fourth step above where the client falls back to IXFR-over-TCP.
There may also be a fourth step where the secondary must fall back to AXFR
because, e.g., the primary does not support IXFR.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">However it is noted that most widely used open source authoritative nameserver
implementations (including both <span>[<a href="#BIND" class="xref">BIND</a>]</span> and <span>[<a href="#NSD" class="xref">NSD</a>]</span> do IXFR using TCP by default
in their latest releases. For BIND TCP connections are sometimes used for SOA
queries but in general they are not used persistently and close after an IXFR
is completed.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-leakage-of-notify-and-soa-message-exchanges">
<section id="section-5.3">
        <h3 id="name-data-leakage-of-notify-and-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-data-leakage-of-notify-and-" class="section-name selfRef">Data Leakage of NOTIFY and SOA Message Exchanges</a>
        </h3>
<p id="section-5.3-1">This section attempts to presents a rationale for considering encrypting the other
messages in the XFR mechanism.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Since the SOA of the published zone can be trivially discovered by simply
querying the publicly available authoritative servers leakage of this RR is not
discussed in the following sections.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div id="notify">
<section id="section-5.3.1">
          <h4 id="name-notify">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-notify" class="section-name selfRef">NOTIFY</a>
          </h4>
<p id="section-5.3.1-1">Unencrypted NOTIFY messages identify configured secondaries on the primary.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2"><span>[<a href="#RFC1996" class="xref">RFC1996</a>]</span> also states:<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.3.1-3">
<pre>
"If ANCOUNT&gt;0, then the answer section represents an
unsecure hint at the new RRset for this (QNAME,QCLASS,QTYPE).
</pre><a href="#section-5.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.3.1-4">But since the only supported QTYPE for NOTIFY is SOA, this does not pose a
potential leak.<a href="#section-5.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="soa">
<section id="section-5.3.2">
          <h4 id="name-soa">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-soa" class="section-name selfRef">SOA</a>
          </h4>
<p id="section-5.3.2-1">For hidden primaries or secondaries the SOA response leaks only the degree of lag of
any downstream secondary.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="updates-to-existing-specifications">
<section id="section-6">
      <h2 id="name-updates-to-existing-specifi">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-updates-to-existing-specifi" class="section-name selfRef">Updates to existing specifications</a>
      </h2>
<p id="section-6-1">For convenience, the term 'XFR-over-TCP' is used in this document to mean both
IXFR-over-TCP and AXFR-over-TCP and therefore statements that use that term update
both <span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> and <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>, and implicitly also apply to XoT.
Differences in behavior specific to XoT are discussed in
<a href="#xot-specification" class="xref">Section 7</a>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Both <span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> and <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> were published sometime before TCP was
considered a first class transport for DNS. <span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span>, in fact, says nothing
with respect to optimizing IXFRs over TCP or re-using already open TCP
connections to perform IXFRs or other queries. Therefore, there arguably is an
implicit assumption (probably unintentional) that a TCP connection is used for
one and only one IXFR request. Indeed, many major open source implementations
currently take this approach. And whilst <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> gives guidance on
connection re-use for AXFR, it pre-dates more recent specifications describing
persistent TCP connections e.g. <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>, <span>[<a href="#RFC7828" class="xref">RFC7828</a>]</span> and AXFR implementations again
often make less than optimal use of open connections.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Given this, new implementations of XoT will clearly benefit from specific guidance on
TCP/TLS connection usage for XFR because this will:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">result in more consistent XoT implementations with better interoperability<a href="#section-6-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.2">remove any need for XoT implementations to support legacy behavior that
XFR-over-TCP implementations have historically often supported<a href="#section-6-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-5">Therefore this document updates both the previous specifications for
XFR-over-TCP to clarify that<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">Implementations MUST use <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> (DNS Transport over TCP - Implementation
Requirements) to optimize the use of TCP connections.<a href="#section-6-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.2">Whilst RFC7766 states that 'DNS clients SHOULD pipeline their queries' on TCP
connections, it did not distinguish between XFRs and other queries for this
behavior. It is now recognized that XFRs are not as latency sensitive as
other queries, and can be significantly more complex for clients to handle
both because of the large amount of state that must be kept and because there
may be multiple messages in the responses. For these reasons it is clarified
here that a valid reason for not pipelining queries is when they are all XFR
queries i.e. clients sending multiple XFRs MAY choose not to pipeline those
queries. Clients that do not pipeline XFR queries, therefore, have no
additional requirements to handle out-of-order or intermingled responses (as
described later) since they will never receive them.<a href="#section-6-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.3">Implementations SHOULD use <span>[<a href="#RFC7828" class="xref">RFC7828</a>]</span> (The edns-tcp-keepalive EDNS0 Option)
to manage persistent connections.<a href="#section-6-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-7">The following sections include detailed clarifications on the updates to XFR
behavior implied in <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> and how the use of <span>[<a href="#RFC7828" class="xref">RFC7828</a>]</span> applies
specifically to XFR exchanges. It also discusses how IXFR and AXFR can reuse
the same TCP connection.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">For completeness, we also mention here the recent specification of extended DNS
error (EDE) codes <span>[<a href="#RFC8914" class="xref">RFC8914</a>]</span>. For zone transfers, when returning REFUSED to a
zone transfer request to an 'unauthorized' client (e.g. where the client is not
listed in an ACL for zone transfers or does not sign the request with the
correct TSIG key), the extended DNS error code 18 (Prohibited) can also be sent.<a href="#section-6-8" class="pilcrow">¶</a></p>
<div id="update-to-rfc1995-for-ixfrovertcp">
<section id="section-6.1">
        <h3 id="name-update-to-rfc1995-for-ixfr-">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-update-to-rfc1995-for-ixfr-" class="section-name selfRef">Update to RFC1995 for IXFR-over-TCP</a>
        </h3>
<p id="section-6.1-1">For clarity - an IXFR-over-TCP server compliant with this specification MUST be
able to handle multiple concurrent IXoT requests on a single TCP connection
(for the same and different zones) and SHOULD send the responses as soon as
they are available, which might be out-of-order compared to the requests.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-to-rfc5936-for-axfrovertcp">
<section id="section-6.2">
        <h3 id="name-update-to-rfc5936-for-axfr-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-update-to-rfc5936-for-axfr-" class="section-name selfRef">Update to RFC5936 for AXFR-over-TCP</a>
        </h3>
<p id="section-6.2-1">For clarity - an AXFR-over-TCP server compliant with this specification MUST be
able to handle multiple concurrent AXoT sessions on a single TCP connection
(for the same and different zones). The response streams for concurrent AXFRs
MAY be intermingled and AXFR-over-TCP clients compliant with this specification
which pipeline AXFR requests MUST be able to handle this.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="updates-to-rfc1995-and-rfc5936-for-xfrovertcp">
<section id="section-6.3">
        <h3 id="name-updates-to-rfc1995-and-rfc5">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-updates-to-rfc1995-and-rfc5" class="section-name selfRef">Updates to RFC1995 and RFC5936 for XFR-over-TCP</a>
        </h3>
<div id="connection-reuse">
<section id="section-6.3.1">
          <h4 id="name-connection-reuse">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-connection-reuse" class="section-name selfRef">Connection reuse</a>
          </h4>
<p id="section-6.3.1-1">As specified, XFR-over-TCP clients SHOULD re-use any existing open TCP connection when
starting any new XFR request to the same primary, and for issuing SOA queries,
instead of opening a new connection. The number of TCP connections between a
secondary and primary SHOULD be minimized (also see <a href="#update-to-rfc7766" class="xref">Section 6.4</a>).<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">Valid reasons for not re-using existing connections might include:<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-3.1">as already noted in <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>, separate connections for different zones might be preferred for operational reasons. In this case the number of concurrent connections for zone transfers SHOULD be limited to the total number of zones transferred between the client and server.<a href="#section-6.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.1-3.2">reaching a configured limit for the number of outstanding queries or XFR requests allowed on a single TCP connection<a href="#section-6.3.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.1-3.3">the message ID pool has already been exhausted on an open connection<a href="#section-6.3.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.1-3.4">a large number of timeouts or slow responses have occurred on an open
connection<a href="#section-6.3.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.1-3.5">an edns-tcp-keepalive EDNS0 option with a timeout of 0 has been received from the
server and the client is in the process of closing the connection (see <a href="#the-ednstcpkeepalive-edns0-option" class="xref">Section 6.3.4</a>)<a href="#section-6.3.1-3.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.3.1-4">If no TCP connections are currently open, XFR clients MAY send SOA queries over
UDP or a new TCP connection.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="axfrs-and-ixfrs-on-the-same-connection">
<section id="section-6.3.2">
          <h4 id="name-axfrs-and-ixfrs-on-the-same">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-axfrs-and-ixfrs-on-the-same" class="section-name selfRef">AXFRs and IXFRs on the same connection</a>
          </h4>
<p id="section-6.3.2-1">Neither <span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> nor <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> explicitly discuss the use of a single TCP
connection for both IXFR and AXFR requests. <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> does make the general statement:<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-6.3.2-2">
<pre>
"Non-AXFR session traffic can also use an open TCP connection."
</pre><a href="#section-6.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.2-3">We clarify here that implementations capable of both AXFR and IXFR and compliant with this specification SHOULD<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.2-4.1">use the same TCP connection for both AXFR and IXFR requests to the same primary<a href="#section-6.3.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.2-4.2">pipeline such requests (if they pipeline XFR requests in general) and MAY intermingle them<a href="#section-6.3.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.2-4.3">send the response(s) for each request as soon as they are available i.e. responses MAY be sent intermingled<a href="#section-6.3.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="xfr-limits">
<section id="section-6.3.3">
          <h4 id="name-xfr-limits">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-xfr-limits" class="section-name selfRef">XFR limits</a>
          </h4>
<p id="section-6.3.3-1">The server MAY limit the number of concurrent IXFRs, AXFRs or total XFR
transfers in progress, or from a given secondary, to protect server resources.
Servers SHOULD return SERVFAIL if this limit is hit, since it is a
transient error and a retry at a later time might succeed.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-ednstcpkeepalive-edns0-option">
<section id="section-6.3.4">
          <h4 id="name-the-edns-tcp-keepalive-edns">
<a href="#section-6.3.4" class="section-number selfRef">6.3.4. </a><a href="#name-the-edns-tcp-keepalive-edns" class="section-name selfRef">The edns-tcp-keepalive EDNS0 Option</a>
          </h4>
<p id="section-6.3.4-1">XFR clients that send the edns-tcp-keepalive EDNS0 option on every XFR request provide the
server with maximum opportunity to update the edns-tcp-keepalive timeout. The XFR server
may use the frequency of recent XFRs to calculate an average update rate as
input to the decision of what edns-tcp-keepalive timeout to use. If the server
does not support edns-tcp-keepalive the client MAY keep the connection open for a
few seconds (<span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> recommends that servers use timeouts of at least a few
seconds).<a href="#section-6.3.4-1" class="pilcrow">¶</a></p>
<p id="section-6.3.4-2">Whilst the specification for EDNS0  <span>[<a href="#RFC6891" class="xref">RFC6891</a>]</span>  does not specifically mention AXFRs, it does say<a href="#section-6.3.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-6.3.4-3">
<pre>
"If an OPT record is present in a received request, compliant
responders MUST include an OPT record in their respective
responses."
</pre><a href="#section-6.3.4-3" class="pilcrow">¶</a>
</div>
<p id="section-6.3.4-4">We clarify here that if an OPT record is present in a received AXFR request,
compliant responders MUST include an OPT record in each of the subsequent AXFR
responses. Note that this requirement, combined with the use of
edns-tcp-keepalive, enables AXFR servers to signal the desire to close a
connection (when existing transactions have competed) due to low resources by
sending an edns-tcp-keepalive EDNS0 option with a timeout of 0 on any AXFR
response. This does not signal that the AXFR is aborted, just that the server
wishes to close the connection as soon as possible.<a href="#section-6.3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="backwards-compatibility">
<section id="section-6.3.5">
          <h4 id="name-backwards-compatibility">
<a href="#section-6.3.5" class="section-number selfRef">6.3.5. </a><a href="#name-backwards-compatibility" class="section-name selfRef">Backwards compatibility</a>
          </h4>
<p id="section-6.3.5-1">Certain legacy behaviors were noted in <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>, with provisions that
implementations may want to offer options to fallback to legacy behavior when
interoperating with servers known not to support <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>. For purposes of
interoperability, IXFR and AXFR implementations may want to continue offering
such configuration options, as well as supporting some behaviors that were
underspecified prior to this work (e.g. performing IXFR and AXFRs on separate
connections). However, XoT implementations should have no need to do so.<a href="#section-6.3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="update-to-rfc7766">
<section id="section-6.4">
        <h3 id="name-update-to-rfc7766">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-update-to-rfc7766" class="section-name selfRef">Update to RFC7766</a>
        </h3>
<p id="section-6.4-1"><span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> made general implementation
recommendations with regard to TCP/TLS connection handling:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-6.4-2">
<pre>
"To mitigate the risk of unintentional server overload, DNS
clients MUST take care to minimize the number of concurrent TCP
connections made to any individual server. It is RECOMMENDED
that for any given client/server interaction there SHOULD be no
more than one connection for regular queries, one for zone
transfers, and one for each protocol that is being used on top
of TCP (for example, if the resolver was using TLS). However,
it is noted that certain primary/ secondary configurations with
many busy zones might need to use more than one TCP connection
for zone transfers for operational reasons (for example, to
support concurrent transfers of multiple zones)."
</pre><a href="#section-6.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4-3">Whilst this recommends a particular behavior for the clients using TCP, it
does not relax the requirement for servers to handle 'mixed' traffic (regular
queries and zone transfers) on any open TCP/TLS connection. It also overlooks the
potential that other transports might want to take the same approach with regard to
using separate connections for different purposes.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">This specification for XoT updates the guidance in <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> to provide the
same separation of connection purpose (regular queries and zone transfers) for
all transports being used on top of TCP.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">Therefore, it is RECOMMENDED that for
each protocol used on top of TCP in any given client/server interaction there
SHOULD be no more than one connection for regular queries and one for zone
transfers.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">As an illustration, it could be imagined that in future such an
interaction could hypothetically include one or all of the following:<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-7.1">one TCP connection for regular queries<a href="#section-6.4-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-7.2">one TCP connection for zone transfers<a href="#section-6.4-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-7.3">one TLS connection for regular queries<a href="#section-6.4-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-7.4">one TLS connection for zone transfers<a href="#section-6.4-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-7.5">one DoH connection for regular queries<a href="#section-6.4-7.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-7.6">one DoH connection for zone transfers<a href="#section-6.4-7.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-8"><a href="#connection-reuse" class="xref">Section 6.3.1</a> has provided specific details of reasons where more than
one connection for a given transport might be required for zone transfers from
a particular client.<a href="#section-6.4-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="xot-specification">
<section id="section-7">
      <h2 id="name-xot-specification">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-xot-specification" class="section-name selfRef">XoT specification</a>
      </h2>
<div id="tls-versions">
<section id="section-7.1">
        <h3 id="name-tls-versions">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-tls-versions" class="section-name selfRef">TLS versions</a>
        </h3>
<p id="section-7.1-1">For improved security all implementations of this specification MUST use only TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> or later.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="port-selection">
<section id="section-7.2">
        <h3 id="name-port-selection">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-port-selection" class="section-name selfRef">Port selection</a>
        </h3>
<p id="section-7.2-1">The connection for XoT SHOULD be established using port 853, as specified in
<span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>, unless there is mutual agreement between the secondary and primary
to use a port other than port 853 for XoT. There MAY be agreement to use
different ports for AXoT and IXoT, or for different zones.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="high-level-xot-descriptions">
<section id="section-7.3">
        <h3 id="name-high-level-xot-descriptions">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-high-level-xot-descriptions" class="section-name selfRef">High level XoT descriptions</a>
        </h3>
<p id="section-7.3-1">It is useful to note that in XoT it is the secondary that initiates
the TLS connection to the primary for a XFR request, so that in terms of
connectivity the secondary is the TLS client and the primary the TLS server.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The figure below provides an outline of the AXoT mechanism including NOTIFYs.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-7.3-3">
<pre>
   Secondary                            Primary

       |              NOTIFY               |
       | &lt;-------------------------------- |  UDP
       | --------------------------------&gt; |
       |          NOTIFY Response          |
       |                                   |
       |                                   |
       |            SOA Request            |
       | --------------------------------&gt; |  UDP (or part of
       | &lt;-------------------------------- |  a TCP/TLS session)
       |           SOA Response            |
       |                                   |
       |                                   |
       |                                   |
       |            AXFR Request           | ---
       | --------------------------------&gt; |   |
       | &lt;-------------------------------- |   |
       |          AXFR Response 1          |   |
       |             (Zone data)           |   |
       |                                   |   |
       | &lt;-------------------------------- |   | TLS
       |          AXFR Response 2          |   | Session
       |             (Zone data)           |   |
       |                                   |   |
       | &lt;-------------------------------- |   |
       |          AXFR Response 3          |   |
       |             (Zone data)           | ---
       |                                   |

              Figure 3. AXoT Mechanism

</pre><a href="#section-7.3-3" class="pilcrow">¶</a>
</div>
<p id="section-7.3-4">The figure below provides an outline of the IXoT mechanism including NOTIFYs.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-7.3-5">
<pre>
   Secondary                            Primary

       |              NOTIFY               |
       | &lt;-------------------------------- |  UDP
       | --------------------------------&gt; |
       |          NOTIFY Response          |
       |                                   |
       |                                   |
       |            SOA Request            |
       | --------------------------------&gt; |  UDP (or part of
       | &lt;-------------------------------- |  a TCP/TLS session)
       |           SOA Response            |
       |                                   |
       |                                   |
       |                                   |
       |            IXFR Request           | ---
       | --------------------------------&gt; |    |
       | &lt;-------------------------------- |    |
       |            IXFR Response          |    |
       |             (Zone data)           |    |
       |                                   |    | TLS
       |                                   |    | session
       |            IXFR Request           |    |
       | --------------------------------&gt; |    |
       | &lt;-------------------------------- |    |
       |            IXFR Response          |    |
       |             (Zone data)           | ---

              Figure 1. IXoT Mechanism

</pre><a href="#section-7.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="xot-transfers">
<section id="section-7.4">
        <h3 id="name-xot-transfers">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-xot-transfers" class="section-name selfRef">XoT transfers</a>
        </h3>
<p id="section-7.4-1">For a zone transfer between two end points to be considered protected with XoT
all XFR requests and response for that zone MUST be sent over TLS connections
where at a minimum:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1">the client MUST authenticate the server by use of an authentication domain
name using a Strict Privacy Profile as described in <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span><a href="#section-7.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.4-2.2">
            <p id="section-7.4-2.2.1">the server MUST validate the client is authorized to request or proxy a zone transfer by
using one or both of the following:<a href="#section-7.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.2.2.1">an IP based ACL (which can be either per-message or per-connection)<a href="#section-7.4-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.4-2.2.2.2">Mutual TLS (mTLS)<a href="#section-7.4-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-7.4-3">The server MAY also require a valid TSIG/SIG(0) signature, but this alone is
not sufficient to authenticate the client or server.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">Authentication mechanisms are discussed in full in <a href="#authentication-mechanisms" class="xref">Section 9</a>
and the rationale for the above requirement in <a href="#xot-authentication" class="xref">Section 10</a>. Transfer
group policies are discussed in <a href="#policies-for-both-axot-and-ixot" class="xref">Section 11</a>.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="xot-connections">
<section id="section-7.5">
        <h3 id="name-xot-connections">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-xot-connections" class="section-name selfRef">XoT connections</a>
        </h3>
<p id="section-7.5-1">The details in <a href="#updates-to-existing-specifications" class="xref">Section 6</a> about e.g., persistent
connections and XFR message handling are fully applicable to XoT connections as
well. However any behavior specified here takes precedence for XoT.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">If no TLS connections are currently open, XoT clients MAY send SOA queries over
UDP or TCP, or TLS.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="xot-vs-adot">
<section id="section-7.6">
        <h3 id="name-xot-vs-adot">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-xot-vs-adot" class="section-name selfRef">XoT vs ADoT</a>
        </h3>
<p id="section-7.6-1">As noted earlier, there is currently no specification for encryption of
connections from recursive resolvers to authoritative servers. Some
authoritatives are experimenting with ADoT and opportunistic encryption has
also been raised as a possibility; it is therefore highly likely that use of
encryption by authoritative servers will evolve in the coming years.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">This raises questions in the short term,S.S. with regard to TLS connection and
message handling for authoritative servers. In particular, there is likely to be
a class of authoritatives that wish to use XoT in the near future with a small
number of configured secondaries but that do wish to support DoT for regular
queries from recursive in that same time frame. These servers have to
potentially cope with probing and direct queries from recursives and from test
servers, and also potential attacks that might wish to make use of TLS to
overload the server.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3"><span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> clearly states that non-AXFR session traffic can use an open TCP
connection, however, this requirement needs to be re-evaluated when considering
applying the same model to XoT. Proposing that a server should also start
responding to all queries received over TLS just because it has enabled XoT
would be equivalent to defining a form of authoritative DoT. This specification
does not propose that, but it also does not prohibit servers from answering
queries unrelated to XFR exchanges over TLS. Rather, this specification
simply outlines in later sections:<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6-4.1">how XoT implementations should utilize EDE codes in response to queries on TLS
connections they are not willing to answer (see <a href="#response-rcodes" class="xref">Section 7.7</a>)<a href="#section-7.6-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.6-4.2">the operational and policy options that a XoT server operator has
with regard to managing TLS connections and messages (see <a href="#xot-server-connection-handling" class="xref">Appendix A</a>)<a href="#section-7.6-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="response-rcodes">
<section id="section-7.7">
        <h3 id="name-response-rcodes">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-response-rcodes" class="section-name selfRef">Response RCODES</a>
        </h3>
<p id="section-7.7-1">XoT clients and servers MUST implement EDE codes. If a XoT server receives
non-XoT traffic it is not willing to answer on a TLS connection it SHOULD
respond with the extended DNS error code 21 - Not Supported
<span>[<a href="#RFC8914" class="xref">RFC8914</a>]</span>. XoT clients should not send any further
queries of this type to the server for a reasonable period of time (for
example, one hour) i.e., long enough that the server configuration or policy
might be updated.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">Historically servers have used the REFUSED RCODE for many situations, and so
clients often had no detailed information on which to base an error or fallback
path when queries were refused. As a result the client behavior could vary
significantly. XoT servers that refuse queries must cater for the fact that
client behavior might vary from continually retrying queries regardless of
receiving REFUSED to every query, or at the other extreme clients may decide to
stop using the server over any transport. This might be because those clients are
either non-XoT clients or do not implement EDE codes.<a href="#section-7.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="axot-specifics">
<section id="section-7.8">
        <h3 id="name-axot-specifics">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-axot-specifics" class="section-name selfRef">AXoT specifics</a>
        </h3>
<div id="padding-axot-responses">
<section id="section-7.8.1">
          <h4 id="name-padding-axot-responses">
<a href="#section-7.8.1" class="section-number selfRef">7.8.1. </a><a href="#name-padding-axot-responses" class="section-name selfRef">Padding AXoT responses</a>
          </h4>
<p id="section-7.8.1-1">The goal of padding AXoT responses would be two fold:<a href="#section-7.8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.8.1-2.1">to obfuscate the actual size of the transferred zone to minimize information
leakage about the entire contents of the zone.<a href="#section-7.8.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.8.1-2.2">to obfuscate the incremental changes to the zone between SOA updates to
minimize information leakage about zone update activity and growth.<a href="#section-7.8.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.8.1-3">Note that the re-use of XoT connections for transfers of multiple different
zones complicates any attempt to analyze the traffic size and timing to
extract information.<a href="#section-7.8.1-3" class="pilcrow">¶</a></p>
<p id="section-7.8.1-4">It is noted here that, depending on the padding policies eventually developed for XoT,
the requirement to obfuscate the total zone size might
require a server to create 'empty' AXoT responses. That is, AXoT responses that
contain no RR's apart from an OPT RR containing the EDNS(0) option for padding.
For example, without this capability the maximum size that a tiny zone could be padded to would
theoretically be limited if there had to be a minimum of 1 RR per packet.<a href="#section-7.8.1-4" class="pilcrow">¶</a></p>
<p id="section-7.8.1-5">However, as with existing AXFR, the last AXoT response message sent MUST
contain the same SOA that was in the first message of the AXoT response series
in order to signal the conclusion of the zone transfer.<a href="#section-7.8.1-5" class="pilcrow">¶</a></p>
<p id="section-7.8.1-6"><span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span> says:<a href="#section-7.8.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-7.8.1-7">
<pre>
"Each AXFR response message SHOULD contain a sufficient number
of RRs to reasonably amortize the per-message overhead, up to
the largest number that will fit within a DNS message (taking
the required content of the other sections into account, as
described below)."
</pre><a href="#section-7.8.1-7" class="pilcrow">¶</a>
</div>
<p id="section-7.8.1-8">'Empty' AXoT responses generated in order to meet a padding requirement will be
exceptions to the above statement. For flexibility, future proofing and in
order to guarantee support for future padding policies, we state here that
secondary implementations MUST be resilient to receiving padded AXoT responses,
including 'empty' AXoT responses that contain only an OPT RR containing the
EDNS(0) option for padding.<a href="#section-7.8.1-8" class="pilcrow">¶</a></p>
<p id="section-7.8.1-9">Recommendation of specific policies for padding AXoT responses are out of scope
for this specification. Detailed considerations of such policies and the
trade-offs involved are expected to be the subject of future work.<a href="#section-7.8.1-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ixot-specifics">
<section id="section-7.9">
        <h3 id="name-ixot-specifics">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-ixot-specifics" class="section-name selfRef">IXoT specifics</a>
        </h3>
<div id="condensation-of-responses">
<section id="section-7.9.1">
          <h4 id="name-condensation-of-responses">
<a href="#section-7.9.1" class="section-number selfRef">7.9.1. </a><a href="#name-condensation-of-responses" class="section-name selfRef">Condensation of responses</a>
          </h4>
<p id="section-7.9.1-1"><span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span> says condensation of responses is optional and MAY be done. Whilst
it does add complexity to generating responses it can significantly reduce the
size of responses. However any such reduction might be offset by increased
message size due to padding. This specification does not update the optionality
of condensation for XoT responses.<a href="#section-7.9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fallback-to-axfr">
<section id="section-7.9.2">
          <h4 id="name-fallback-to-axfr">
<a href="#section-7.9.2" class="section-number selfRef">7.9.2. </a><a href="#name-fallback-to-axfr" class="section-name selfRef">Fallback to AXFR</a>
          </h4>
<p id="section-7.9.2-1">Fallback to AXFR can happen, for example, if the server is not able to provide
an IXFR for the requested SOA. Implementations differ in how long they store
zone deltas and how many may be stored at any one time.<a href="#section-7.9.2-1" class="pilcrow">¶</a></p>
<p id="section-7.9.2-2">Just as with IXFR-over-TCP, after a failed IXFR a IXoT client SHOULD request
the AXFR on the already open XoT connection.<a href="#section-7.9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="padding-of-ixot-responses">
<section id="section-7.9.3">
          <h4 id="name-padding-of-ixot-responses">
<a href="#section-7.9.3" class="section-number selfRef">7.9.3. </a><a href="#name-padding-of-ixot-responses" class="section-name selfRef">Padding of IXoT responses</a>
          </h4>
<p id="section-7.9.3-1">The goal of padding IXoT responses would be to obfuscate the incremental
changes to the zone between SOA updates to minimize information leakage about
zone update activity and growth. Both the size and timing of the IXoT responses could
reveal information.<a href="#section-7.9.3-1" class="pilcrow">¶</a></p>
<p id="section-7.9.3-2">IXFR responses can vary in size greatly from the order of 100 bytes for one or
two record updates, to tens of thousands of bytes for large dynamic DNSSEC
signed zones. The frequency of IXFR responses can also depend greatly on if and
how the zone is DNSSEC signed.<a href="#section-7.9.3-2" class="pilcrow">¶</a></p>
<p id="section-7.9.3-3">In order to guarantee support for future padding policies, we state here that
secondary implementations MUST be resilient to receiving padded IXoT responses.<a href="#section-7.9.3-3" class="pilcrow">¶</a></p>
<p id="section-7.9.3-4">Recommendation of specific policies for padding IXoT responses are out of scope
for this specification. Detailed considerations of such policies and the
trade-offs involved are expected to be the subject of future work.<a href="#section-7.9.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="name-compression-and-maximum-payload-sizes">
<section id="section-7.10">
        <h3 id="name-name-compression-and-maximu">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-name-compression-and-maximu" class="section-name selfRef">Name compression and maximum payload sizes</a>
        </h3>
<p id="section-7.10-1">It is noted here that name compression <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> can be used in XFR responses
to reduce the size of the payload, however the maximum value of the offset that
can be used in the name compression pointer structure is 16384. For some DNS
implementations this limits the size of an individual XFR response used in
practice to something around the order of 16kB. In principle, larger
payload sizes can be supported for some responses with more sophisticated
approaches (e.g. by pre-calculating the maximum offset required).<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">Implementations may wish to offer options to disable name compression for XoT
responses to enable larger payloads. This might be particularly helpful when
padding is used since minimizing the payload size is not necessarily a useful
optimization in this case and disabling name compression will reduce the
resources required to construct the payload.<a href="#section-7.10-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="multiprimary-configurations">
<section id="section-8">
      <h2 id="name-multi-primary-configuration">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-multi-primary-configuration" class="section-name selfRef">Multi-primary Configurations</a>
      </h2>
<p id="section-8-1">Also known as multi-master configurations this model can provide flexibility
and redundancy particularly for IXFR. A secondary will receive one or more
NOTIFY messages and can send an SOA to all of the configured primaries. It can
then choose to send an XFR request to the primary with the highest SOA (or
other criteria, e.g., RTT).<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">When using persistent connections the secondary may have a XoT connection
already open to one or more primaries. Should a secondary preferentially
request an XFR from a primary to which it already has an open XoT connection
or the one with the highest SOA (assuming it doesn't have a connection open to
it already)?<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Two extremes can be envisaged here. The first one can be considered a 'preferred
primary connection' model. In this case the secondary continues to use one
persistent connection to a single primary until it has reason not to. Reasons
not to might include the primary repeatedly closing the connection, long RTTs on
transfers or the SOA of the primary being an unacceptable lag behind the SOA of
an alternative primary.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The other extreme can be considered a 'parallel primary connection' model. Here
a secondary could keep multiple persistent connections open to all available
primaries and only request XFRs from the primary with the highest serial number.
Since normally the number of secondaries and primaries in direct contact in a
transfer group is reasonably low this might be feasible if latency is the most
significant concern.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Recommendation of a particular scheme is out of scope of this document but
implementations are encouraged to provide configuration options that allow
operators to make choices about this behavior.<a href="#section-8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-mechanisms">
<section id="section-9">
      <h2 id="name-authentication-mechanisms">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-authentication-mechanisms" class="section-name selfRef">Authentication mechanisms</a>
      </h2>
<p id="section-9-1">To provide context to the requirements in section <a href="#xot-transfers" class="xref">Section 7.4</a>, this
section provides a brief summary of some of the existing authentication and
validation mechanisms (both transport independent and TLS specific) that are
available when performing zone transfers.
<a href="#xot-authentication" class="xref">Section 10</a> then discusses in more details specifically how a
combination of TLS authentication, TSIG and IP based ACLs interact for XoT.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">We classify the mechanisms based on the following properties:<a href="#section-9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-3.1">'Data Origin Authentication' (DO): Authentication that the DNS message originated
from the party with whom credentials were shared, and of the data integrity
of the message contents (the originating party may or may not be party
operating the far end of a TCP/TLS connection in a 'proxy' scenario).<a href="#section-9-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-3.2">'Channel Confidentiality' (CC): Confidentiality of the communication channel between the
client and server (i.e. the two end points of a TCP/TLS connection) from passive surveillance.<a href="#section-9-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-3.3">'Channel Authentication' (CA): Authentication of the identity of party to whom a TCP/TLS
connection is made (this might not be a direct connection between the primary
and secondary in a proxy scenario).<a href="#section-9-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<div id="tsig">
<section id="section-9.1">
        <h3 id="name-tsig">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-tsig" class="section-name selfRef">TSIG</a>
        </h3>
<p id="section-9.1-1">TSIG <span>[<a href="#RFC2845" class="xref">RFC2845</a>]</span> provides a mechanism for two or more parties to use shared
secret keys which can then be used to create a message digest to protect
individual DNS messages. This allows each party to authenticate that a request
or response (and the data in it) came from the other party, even if it was
transmitted over an unsecured channel or via a proxy.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Properties: Data origin authentication<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sig0">
<section id="section-9.2">
        <h3 id="name-sig0">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-sig0" class="section-name selfRef">SIG(0)</a>
        </h3>
<p id="section-9.2-1">SIG(0) <span>[<a href="#RFC2931" class="xref">RFC2931</a>]</span> similarly also provides a mechanism to digitally sign a DNS
message but uses public key authentication, where the public keys are stored in
DNS as KEY RRs and a private key is stored at the signer.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">Properties: Data origin authentication<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls">
<section id="section-9.3">
        <h3 id="name-tls">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-tls" class="section-name selfRef">TLS</a>
        </h3>
<div id="opportunistic-tls">
<section id="section-9.3.1">
          <h4 id="name-opportunistic-tls">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-opportunistic-tls" class="section-name selfRef">Opportunistic TLS</a>
          </h4>
<p id="section-9.3.1-1">Opportunistic TLS for DoT is defined in <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span> and can provide a defense against passive
surveillance, providing on-the-wire confidentiality. Essentially<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3.1-2.1">clients that know authentication information for a server SHOULD try to authenticate the server<a href="#section-9.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.3.1-2.2">however they MAY fallback to using TLS without authentication and<a href="#section-9.3.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.3.1-2.3">they MAY fallback to using cleartext if TLS is not available.<a href="#section-9.3.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.3.1-3">As such it does not offer a defense against active attacks (e.g. a MitM attack
on the connection from client to server), and is not considered as useful for XoT.<a href="#section-9.3.1-3" class="pilcrow">¶</a></p>
<p id="section-9.3.1-4">Properties: None guaranteed.<a href="#section-9.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="strict-tls">
<section id="section-9.3.2">
          <h4 id="name-strict-tls">
<a href="#section-9.3.2" class="section-number selfRef">9.3.2. </a><a href="#name-strict-tls" class="section-name selfRef">Strict TLS</a>
          </h4>
<p id="section-9.3.2-1">Strict TLS for DoT <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span> requires that a client is configured with an
authentication domain name (and/or SPKI pinset) that MUST be used to
authenticate the TLS handshake with the server. If authentication of the server
fails, the client will not proceed with the connection. This provides a defense
for the client against active surveillance, providing client-to-server
authentication and end-to-end channel confidentiality.<a href="#section-9.3.2-1" class="pilcrow">¶</a></p>
<p id="section-9.3.2-2">Properties: Channel confidentiality and authentication (of the server).<a href="#section-9.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mutual-tls">
<section id="section-9.3.3">
          <h4 id="name-mutual-tls">
<a href="#section-9.3.3" class="section-number selfRef">9.3.3. </a><a href="#name-mutual-tls" class="section-name selfRef">Mutual TLS</a>
          </h4>
<p id="section-9.3.3-1">This is an extension to Strict TLS <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span> which requires that a client is
configured with an authentication domain name (and/or SPKI pinset) and a client
certificate. The client offers the certificate for authentication by the server
and the client can authentic the server the same way as in Strict TLS. This
provides a defense for both parties against active surveillance, providing
bi-directional authentication and end-to-end channel confidentiality.<a href="#section-9.3.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3.3-2">Properties: Channel confidentiality and mutual authentication.<a href="#section-9.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ip-based-acl-on-the-primary">
<section id="section-9.4">
        <h3 id="name-ip-based-acl-on-the-primary">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-ip-based-acl-on-the-primary" class="section-name selfRef">IP Based ACL on the Primary</a>
        </h3>
<p id="section-9.4-1">Most DNS server implementations offer an option to configure an IP based Access
Control List (ACL), which is often used in combination with TSIG based ACLs to
restrict access to zone transfers on primary servers on a per query basis.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">This is also possible with XoT but it must be noted that, as with TCP, the
implementation of such an ACL cannot be enforced on the primary until an XFR
request is received on an established connection.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">As discussed in <a href="#xot-server-connection-handling" class="xref">Appendix A</a> an IP based per connection ACL
could also be implemented where only TLS connections from recognized
secondaries are accepted.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4-4">Properties: Channel authentication of the client.<a href="#section-9.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="zonemd">
<section id="section-9.5">
        <h3 id="name-zonemd">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-zonemd" class="section-name selfRef">ZONEMD</a>
        </h3>
<p id="section-9.5-1">For completeness, we also describe Message Digest for DNS Zones (ZONEMD)
<span>[<a href="#I-D.ietf-dnsop-dns-zone-digest" class="xref">I-D.ietf-dnsop-dns-zone-digest</a>]</span> here. The message digest
is a mechanism that can be used to verify the content of a standalone zone. It
is designed to be independent of the transmission channel or mechanism, allowing
a general consumer of a zone to do origin authentication of the entire zone
contents. Note that the current version of <span>[<a href="#I-D.ietf-dnsop-dns-zone-digest" class="xref">I-D.ietf-dnsop-dns-zone-digest</a>]</span>
states:<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2"><code>As specified herein, ZONEMD is impractical for large, dynamic zones due to the
time and resources required for digest calculation. However, The ZONEMD record
is extensible so that new digest schemes may be added in the future to support
large, dynamic zones.</code><a href="#section-9.5-2" class="pilcrow">¶</a></p>
<p id="section-9.5-3">It is complementary but orthogonal the above mechanisms; and can be used in
conjunction with XoT but is not considered further here.<a href="#section-9.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="xot-authentication">
<section id="section-10">
      <h2 id="name-xot-authentication">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-xot-authentication" class="section-name selfRef">XoT authentication</a>
      </h2>
<p id="section-10-1">It is noted that zone transfer scenarios can vary from a simple single
primary/secondary relationship where both servers are under the control of a
single operator to a complex hierarchical structure which includes proxies and
multiple operators. Each deployment scenario will require specific analysis to
determine which combination of authentication methods are best suited to the
deployment model in question.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The XoT authentication requirement specified in <a href="#xot-transfers" class="xref">Section 7.4</a> addresses the
issue of ensuring that the transfers is encrypted between the two endpoints
directly involved in the current transfers. The following table summarized the
properties of a selection of the mechanisms discussed in
<a href="#authentication-mechanisms" class="xref">Section 9</a>. The two letter acronyms for the properties are
used below and (S) indicates the secondary and (P) indicates
the primary.<a href="#section-10-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Method</th>
            <th class="text-center" rowspan="1" colspan="1">DO(S)</th>
            <th class="text-center" rowspan="1" colspan="1">CC(S)</th>
            <th class="text-center" rowspan="1" colspan="1">CA(S)</th>
            <th class="text-center" rowspan="1" colspan="1">DO(P)</th>
            <th class="text-center" rowspan="1" colspan="1">CC(P)</th>
            <th class="text-center" rowspan="1" colspan="1">CA(P)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Strict TLS</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Mutual TLS</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ACL on primary</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TSIG</td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1">Y</td>
            <td class="text-center" rowspan="1" colspan="1"></td>
            <td class="text-center" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<p id="section-10-4">Table 1: Properties of Authentication methods for XoT<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">Based on this analysis it can be seen that:<a href="#section-10-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-6.1">Using just mutual TLS can be considered a standalone solution since both end points are authenticated<a href="#section-10-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-6.2">Using Strict TLS and an IP based ACL on the primary also provides authentication of both end points<a href="#section-10-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-6.3">Additional use of TSIG (or equally SIG(0)) can also provide data origin
authentication which might be desirable for deployments that include a proxy
between the secondary and primary, but is not part of the XoT requirement
because it does nothing to guarantee channel confidentiality or
authentication.<a href="#section-10-6.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="policies-for-both-axot-and-ixot">
<section id="section-11">
      <h2 id="name-policies-for-both-axot-and-">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-policies-for-both-axot-and-" class="section-name selfRef">Policies for Both AXoT and IXoT</a>
      </h2>
<p id="section-11-1">Whilst the protection of the zone contents in a transfer between two end points
can be provided by the XoT protocol, the protection of all the transfers of a
given zone requires operational administration and policy management.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">We call the entire group of servers involved in XFR for a particular set of
zones (all the primaries and all the secondaries) the 'transfer group'.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">Within any transfer group both AXFRs and IXFRs for a zone MUST all use the
same policy, e.g., if AXFRs use AXoT all IXFRs MUST use IXoT.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">In order to assure the confidentiality of the zone information, the entire
transfer group MUST have a consistent policy of requiring confidentiality. If
any do not, this is a weak link for attackers to exploit.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">An individual zone transfer is not considered protected by XoT unless
both the client and server are configured to use only XoT and the overall zone
transfer is not considered protected until all members of the transfer group
are configured to use only XoT with all other transfers servers (see <a href="#implementation-considerations" class="xref">Section 12</a>).<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">A XoT policy should specify<a href="#section-11-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-7.1">What kind of TLS is required (Strict or Mutual TLS)<a href="#section-11-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-7.2">or if an IP based ACL is required.<a href="#section-11-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-7.3">(optionally) if TSIG/SIG(0) is required<a href="#section-11-7.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-8">Since this may require configuration of a number of servers who may be under
the control of different operators the desired consistency could be hard to
enforce and audit in practice.<a href="#section-11-8" class="pilcrow">¶</a></p>
<p id="section-11-9">Certain aspects of the Policies can be relatively easily tested independently,
e.g., by requesting zone transfers without TSIG, from unauthorized IP addresses
or over cleartext DNS. Other aspects such as if a secondary will accept data
without a TSIG digest or if secondaries are using Strict as opposed to
Opportunistic TLS are more challenging.<a href="#section-11-9" class="pilcrow">¶</a></p>
<p id="section-11-10">The mechanics of co-ordinating or enforcing such policies are out of the scope
of this document but may be the subject of future operational guidance.<a href="#section-11-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-considerations">
<section id="section-12">
      <h2 id="name-implementation-consideratio">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-12-1">Server implementations may want to also offer options that allow ACLs on a zone
to specify that a specific client can use either XoT or TCP. This would allow
for flexibility while clients are migrating to XoT.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">Client implementations may similarly want to offer options to cater for the
multi-primary case where the primaries are migrating to XoT.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">Such configuration options MUST only be used in a 'migration mode' though, and
therefore should be used with care.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">It is noted that use of a TLS proxy in front of the primary server is a simple
deployment solution that can enable server side XoT.<a href="#section-12-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-13-1">None.<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="section-14">
      <h2 id="name-implementation-status">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-14-1">[THIS SECTION TO BE REMOVED BEFORE PUBLICATION] This section records the status
of known implementations of the protocol defined by this specification at the
time of posting of this Internet-Draft, and is based on a proposal described in
<span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">A summary of current behavior and implementation status can be found here: <a href="https://dnsprivacy.org/wiki/display/DP/DNS+Privacy+Implementation+Status#DNSPrivacyImplementationStatus-XFR/XoTImplementationstatus">XoT implementation status</a><a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">Specific recent activity includes:<a href="#section-14-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14-4">
<li id="section-14-4.1">The 1.9.2 version of
<a href="https://github.com/NLnetLabs/unbound/blob/release-1.9.2/doc/Changelog">Unbound</a>
includes an option to perform AXoT (instead of AXFR-over-TCP).<a href="#section-14-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-14-4.2">
          <p id="section-14-4.2.1">There are currently open pull requests against NSD to implement<a href="#section-14-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14-4.2.2">
<li id="section-14-4.2.2.1">Connection re-use by default during <a href="https://github.com/NLnetLabs/nsd/pull/145">XFR-over-TCP</a><a href="#section-14-4.2.2.1" class="pilcrow">¶</a>
</li>
            <li id="section-14-4.2.2.2">
              <p id="section-14-4.2.2.2.1">Client side <a href="https://github.com/NLnetLabs/nsd/pull/149">XFR-over-TLS</a><a href="#section-14-4.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-14-4.2.2.2.2"></p>
</li>
          </ol>
</li>
        <li id="section-14-4.3">Version 9.17.7 of BIND contained an initial implementation of DoT, implementation of XoT is planned for early <a href="https://gitlab.isc.org/isc-projects/bind9/-/issues/1784">2021</a><a href="#section-14-4.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-14-5">Both items 1. and 2.2. listed above require the client (secondary) to
authenticate the server (primary) using a configured authentication domain name
if XoT is used.<a href="#section-14-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-15-1">This document specifies a security measure against a DNS risk: the risk that an
attacker collects entire DNS zones through eavesdropping on clear text DNS zone
transfers.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">This does not mitigate:<a href="#section-15-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-3.1">the risk that some level of zone activity might be inferred by observing zone
transfer sizes and timing on encrypted connections (even with padding
applied), in combination with obtaining SOA records by directly querying
authoritative servers.<a href="#section-15-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.2">the risk that hidden primaries might be inferred or identified via
observation of encrypted connections.<a href="#section-15-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.3">the risk of zone contents being obtained via zone enumeration techniques.<a href="#section-15-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-15-4">Security concerns of DoT are outlined in <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span> and <span>[<a href="#RFC8310" class="xref">RFC8310</a>]</span>.<a href="#section-15-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-16">
      <h2 id="name-acknowledgements">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-16-1">The authors thank Tony Finch, Benno Overeinder, Shumon Huque
and Tim Wicinski and many other members of DPRIVE for review and discussions.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">The authors particularly thank Peter van Dijk, Ondrej Sury, Brian Dickson and
several other open source DNS implementors for valuable discussion and
clarification on the issue associated with pipelining XFR queries and handling
out-of-order/intermingled responses.<a href="#section-16-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-17">
      <h2 id="name-contributors">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-17-1">Significant contributions to the document were made by:<a href="#section-17-1" class="pilcrow">¶</a></p>
<p id="section-17-2">Han Zhang 

   Salesforce

   San Francisco, CA

   United States<a href="#section-17-2" class="pilcrow">¶</a></p>
<p id="section-17-3">Email: hzhang@salesforce.com<a href="#section-17-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changelog">
<section id="section-18">
      <h2 id="name-changelog">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-changelog" class="section-name selfRef">Changelog</a>
      </h2>
<p id="section-18-1">draft-ietf-dprive-xfr-over-tls-07<a href="#section-18-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-2.1">Reference RFC7942 in the implementation status section<a href="#section-18-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-2.2">Convert the URIs that will remain on publication to references<a href="#section-18-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-2.3">Correct typos in acknowledgments<a href="#section-18-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-3">draft-ietf-dprive-xfr-over-tls-06<a href="#section-18-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-4.1">Update text relating to pipelining and connection reuse after WGLC comments.<a href="#section-18-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-4.2">Add link to implementation status matrix<a href="#section-18-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-4.3">Various typos<a href="#section-18-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-5">draft-ietf-dprive-xfr-over-tls-05<a href="#section-18-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-6.1">Remove the open questions that received no comments.<a href="#section-18-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-6.2">Add more detail to the implementation section<a href="#section-18-6.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-7">draft-ietf-dprive-xfr-over-tls-04<a href="#section-18-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-8.1">Add Github repository<a href="#section-18-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-8.2">Fix typos and references and improve layout.<a href="#section-18-8.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-9">draft-ietf-dprive-xfr-over-tls-03<a href="#section-18-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-10.1">Remove propose to use ALPN<a href="#section-18-10.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.2">Clarify updates to both RFC1995 and RFC5936 by adding specific sections on this<a href="#section-18-10.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.3">Add a section on the threat model<a href="#section-18-10.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.4">Convert all SVG diagrams to ASCII art<a href="#section-18-10.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.5">Add discussions on concurrency limits<a href="#section-18-10.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.6">Add discussions on Extended DNS error codes<a href="#section-18-10.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.7">Re-work authentication requirements and discussion<a href="#section-18-10.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-10.8">Add appendix discussion TLS connection management<a href="#section-18-10.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-11">draft-ietf-dprive-xfr-over-tls-02<a href="#section-18-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-12.1">Significantly update descriptions for both AXoT and IXoT for message and
connection handling taking into account previous specifications in more detail<a href="#section-18-12.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-12.2">Add use of APLN and limitations on traffic on XoT connections.<a href="#section-18-12.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-12.3">Add new discussions of padding for both AXoT and IXoT<a href="#section-18-12.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-12.4">Add text on SIG(0)<a href="#section-18-12.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-12.5">Update security considerations<a href="#section-18-12.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-12.6">Move multi-primary considerations to earlier as they are related to connection
handling<a href="#section-18-12.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-13">draft-ietf-dprive-xfr-over-tls-01<a href="#section-18-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-14.1">Minor editorial updates<a href="#section-18-14.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-14.2">Add requirement for TLS 1.3. or later<a href="#section-18-14.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-15">draft-ietf-dprive-xfr-over-tls-00<a href="#section-18-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-16.1">Rename after adoption and reference update.<a href="#section-18-16.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-16.2">Add placeholder for SIG(0) discussion<a href="#section-18-16.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-18-16.3">Update section on ZONEMD<a href="#section-18-16.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-17">draft-hzpa-dprive-xfr-over-tls-02<a href="#section-18-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-18.1">Substantial re-work of the document.<a href="#section-18-18.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-19">draft-hzpa-dprive-xfr-over-tls-01<a href="#section-18-19" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-20.1">Editorial changes, updates to references.<a href="#section-18-20.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-18-21">draft-hzpa-dprive-xfr-over-tls-00<a href="#section-18-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-18-22.1">Initial commit<a href="#section-18-22.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-19">
      <h2 id="name-references">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-19.1">
        <h3 id="name-normative-references">
<a href="#section-19.1" class="section-number selfRef">19.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.vcelak-nsec5">[I-D.vcelak-nsec5]</dt>
        <dd>
<span class="refAuthor">Vcelak, J.</span><span class="refAuthor">, Goldberg, S.</span><span class="refAuthor">, Papadopoulos, D.</span><span class="refAuthor">, Huque, S.</span><span class="refAuthor">, and D. Lawrence</span>, <span class="refTitle">"NSEC5, DNSSEC Authenticated Denial of Existence"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-vcelak-nsec5-08</span>, <time datetime="2018-12-29" class="refDate">29 December 2018</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-vcelak-nsec5-08.txt">http://www.ietf.org/internet-drafts/draft-vcelak-nsec5-08.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1995">[RFC1995]</dt>
        <dd>
<span class="refAuthor">Ohta, M.</span>, <span class="refTitle">"Incremental Zone Transfer in DNS"</span>, <span class="seriesInfo">RFC 1995</span>, <span class="seriesInfo">DOI 10.17487/RFC1995</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1995">https://www.rfc-editor.org/info/rfc1995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1996">[RFC1996]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"</span>, <span class="seriesInfo">RFC 1996</span>, <span class="seriesInfo">DOI 10.17487/RFC1996</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1996">https://www.rfc-editor.org/info/rfc1996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2845">[RFC2845]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span><span class="refAuthor">, Gudmundsson, O.</span><span class="refAuthor">, Eastlake 3rd, D.</span><span class="refAuthor">, and B. Wellington</span>, <span class="refTitle">"Secret Key Transaction Authentication for DNS (TSIG)"</span>, <span class="seriesInfo">RFC 2845</span>, <span class="seriesInfo">DOI 10.17487/RFC2845</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2845">https://www.rfc-editor.org/info/rfc2845</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5936">[RFC5936]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span><span class="refAuthor"> and A. Hoenes, Ed.</span>, <span class="refTitle">"DNS Zone Transfer Protocol (AXFR)"</span>, <span class="seriesInfo">RFC 5936</span>, <span class="seriesInfo">DOI 10.17487/RFC5936</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5936">https://www.rfc-editor.org/info/rfc5936</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Aboba, B.</span><span class="refAuthor">, Peterson, J.</span><span class="refAuthor">, Morris, J.</span><span class="refAuthor">, Hansen, M.</span><span class="refAuthor">, and R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7626">[RFC7626]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Privacy Considerations"</span>, <span class="seriesInfo">RFC 7626</span>, <span class="seriesInfo">DOI 10.17487/RFC7626</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7626">https://www.rfc-editor.org/info/rfc7626</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Bellis, R.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7828">[RFC7828]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span><span class="refAuthor">, Abley, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, and R. Bellis</span>, <span class="refTitle">"The edns-tcp-keepalive EDNS0 Option"</span>, <span class="seriesInfo">RFC 7828</span>, <span class="seriesInfo">DOI 10.17487/RFC7828</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7828">https://www.rfc-editor.org/info/rfc7828</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span><span class="refAuthor">, Zhu, L.</span><span class="refAuthor">, Heidemann, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, Wessels, D.</span><span class="refAuthor">, and P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span><span class="refAuthor">, Gillmor, D.</span><span class="refAuthor">, and T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor">, Sullivan, A.</span><span class="refAuthor">, and K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8914">[RFC8914]</dt>
      <dd>
<span class="refAuthor">Kumari, W.</span><span class="refAuthor">, Hunt, E.</span><span class="refAuthor">, Arends, R.</span><span class="refAuthor">, Hardaker, W.</span><span class="refAuthor">, and D. Lawrence</span>, <span class="refTitle">"Extended DNS Errors"</span>, <span class="seriesInfo">RFC 8914</span>, <span class="seriesInfo">DOI 10.17487/RFC8914</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8914">https://www.rfc-editor.org/info/rfc8914</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-19.2">
        <h3 id="name-informative-references">
<a href="#section-19.2" class="section-number selfRef">19.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BIND">[BIND]</dt>
        <dd>
<span class="refAuthor">ISC</span>, <span class="refTitle">"BIND 9"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.isc.org/bind/">https://www.isc.org/bind/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnsop-dns-zone-digest">[I-D.ietf-dnsop-dns-zone-digest]</dt>
        <dd>
<span class="refAuthor">Wessels, D.</span><span class="refAuthor">, Barber, P.</span><span class="refAuthor">, Weinberg, M.</span><span class="refAuthor">, Kumari, W.</span><span class="refAuthor">, and W. Hardaker</span>, <span class="refTitle">"Message Digest for DNS Zones"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-dns-zone-digest-14</span>, <time datetime="2020-10-15" class="refDate">15 October 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dnsop-dns-zone-digest-14.txt">http://www.ietf.org/internet-drafts/draft-ietf-dnsop-dns-zone-digest-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dprive-dnsoquic">[I-D.ietf-dprive-dnsoquic]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and S. Dickinson</span>, <span class="refTitle">"Specification of DNS over Dedicated QUIC Connections"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dprive-dnsoquic-01</span>, <time datetime="2020-10-20" class="refDate">20 October 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dprive-dnsoquic-01.txt">http://www.ietf.org/internet-drafts/draft-ietf-dprive-dnsoquic-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dprive-phase2-requirements">[I-D.ietf-dprive-phase2-requirements]</dt>
        <dd>
<span class="refAuthor">Livingood, J.</span><span class="refAuthor">, Mayrhofer, A.</span><span class="refAuthor">, and B. Overeinder</span>, <span class="refTitle">"DNS Privacy Requirements for Exchanges between Recursive Resolvers and Authoritative Servers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dprive-phase2-requirements-02</span>, <time datetime="2020-11-02" class="refDate">2 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dprive-phase2-requirements-02.txt">http://www.ietf.org/internet-drafts/draft-ietf-dprive-phase2-requirements-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-esni">[I-D.ietf-tls-esni]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Oku, K.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"TLS Encrypted Client Hello"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-09</span>, <time datetime="2020-12-16" class="refDate">16 December 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-09.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.vandijk-dprive-ds-dot-signal-and-pin">[I-D.vandijk-dprive-ds-dot-signal-and-pin]</dt>
        <dd>
<span class="refAuthor">Dijk, P.</span><span class="refAuthor">, Geuze, R.</span><span class="refAuthor">, and E. Bretelle</span>, <span class="refTitle">"Signalling Authoritative DoT support in DS records, with key pinning"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-vandijk-dprive-ds-dot-signal-and-pin-01</span>, <time datetime="2020-07-13" class="refDate">13 July 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-vandijk-dprive-ds-dot-signal-and-pin-01.txt">http://www.ietf.org/internet-drafts/draft-vandijk-dprive-ds-dot-signal-and-pin-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="nist-guide">[nist-guide]</dt>
        <dd>
<span class="refAuthor">Chandramouli, R.</span><span class="refAuthor"> and S. Rose</span>, <span class="refTitle">"Secure Domain Name System (DNS) Deployment Guide"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NSD">[NSD]</dt>
        <dd>
<span class="refAuthor">NLnet Labs</span>, <span class="refTitle">"NSD"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.nlnetlabs.nl/projects/nsd/about/">https://www.nlnetlabs.nl/projects/nsd/about/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1982">[RFC1982]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span><span class="refAuthor"> and R. Bush</span>, <span class="refTitle">"Serial Number Arithmetic"</span>, <span class="seriesInfo">RFC 1982</span>, <span class="seriesInfo">DOI 10.17487/RFC1982</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1982">https://www.rfc-editor.org/info/rfc1982</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2931">[RFC2931]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"DNS Request and Transaction Signatures ( SIG(0)s )"</span>, <span class="seriesInfo">RFC 2931</span>, <span class="seriesInfo">DOI 10.17487/RFC2931</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2931">https://www.rfc-editor.org/info/rfc2931</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5155">[RFC5155]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span><span class="refAuthor">, Sisson, G.</span><span class="refAuthor">, Arends, R.</span><span class="refAuthor">, and D. Blacka</span>, <span class="refTitle">"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"</span>, <span class="seriesInfo">RFC 5155</span>, <span class="seriesInfo">DOI 10.17487/RFC5155</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5155">https://www.rfc-editor.org/info/rfc5155</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span><span class="refAuthor">, Graff, M.</span><span class="refAuthor">, and P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6891">https://www.rfc-editor.org/info/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor"> and A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="xot-server-connection-handling">
<section id="section-appendix.a">
      <h2 id="name-xot-server-connection-handl">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-xot-server-connection-handl" class="section-name selfRef">XoT server connection handling</a>
      </h2>
<p id="section-appendix.a-1">For completeness, it is noted that an earlier version of the specification
suggested using a XoT specific ALPN to negotiate TLS connections that supported
only a limited set of queries (SOA, XRFs) however this did not gain support.
Reasons given included additional code complexity and proxies having no natural
way to forward the ALPN signal to DNS nameservers over TCP connections.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<div id="only-listen-on-tls-on-a-specific-ip-address">
<section id="section-a.1">
        <h2 id="name-only-listen-on-tls-on-a-spe">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-only-listen-on-tls-on-a-spe" class="section-name selfRef">Only listen on TLS on a specific IP address</a>
        </h2>
<p id="section-a.1-1">Obviously a nameserver which hosts a zone and services queries for the zone on
an IP address published in an NS record may wish to use a separate IP address
for listening on TLS for XoT, only publishing that address to its secondaries.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<p id="section-a.1-2">Pros: Probing of the public IP address will show no support for TLS. ACLs will
prevent zone transfer on all transports on a per query basis.<a href="#section-a.1-2" class="pilcrow">¶</a></p>
<p id="section-a.1-3">Cons: Attackers passively observing traffic will still be able to observe TLS
connections to the separate address.<a href="#section-a.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-specific-tls-acceptance">
<section id="section-a.2">
        <h2 id="name-client-specific-tls-accepta">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-client-specific-tls-accepta" class="section-name selfRef">Client specific TLS acceptance</a>
        </h2>
<p id="section-a.2-1">Primaries that include IP based ACLs and/or mutual TLS in their authentication models
have the option of only accepting TLS connections from authorized clients. This
could be implemented using a proxy or directly in DNS implementation.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<p id="section-a.2-2">Pros: Connection management happens at setup time. The maximum number of TLS
connections a server will have to support can be easily assessed. Once the
connection is accepted the server might well be willing to answer any query on
that connection since it is coming from a configured secondary and a specific
response policy on the connection may not be needed (see below).<a href="#section-a.2-2" class="pilcrow">¶</a></p>
<p id="section-a.2-3">Cons: Currently, none of the major open source DNS authoritative
implementations support such an option.<a href="#section-a.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sni-based-tls-acceptance">
<section id="section-a.3">
        <h2 id="name-sni-based-tls-acceptance">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-sni-based-tls-acceptance" class="section-name selfRef">SNI based TLS acceptance</a>
        </h2>
<p id="section-a.3-1">Primaries could also choose to only accept TLS connections based on an SNI that
was published only to their secondaries.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<p id="section-a.3-2">Pros: Reduces the number of accepted connections.<a href="#section-a.3-2" class="pilcrow">¶</a></p>
<p id="section-a.3-3">Cons: As above. For SNIs sent in the clear, this would still allow attackers
passively observing traffic to potentially abuse this mechanism. The use of
Encrypted Client Hello <span>[<a href="#I-D.ietf-tls-esni" class="xref">I-D.ietf-tls-esni</a>]</span> may be of use here.<a href="#section-a.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-specific-response-policies">
<section id="section-a.4">
        <h2 id="name-tls-specific-response-polic">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-tls-specific-response-polic" class="section-name selfRef">TLS specific response policies</a>
        </h2>
<p id="section-a.4-1">Some primaries might rely on TSIG/SIG(0) combined with per-query IP based
ACLs to authenticate secondaries. In this case the primary must accept all
incoming TLS connections and then apply a TLS specific response policy on a per
query basis.<a href="#section-a.4-1" class="pilcrow">¶</a></p>
<p id="section-a.4-2">As an aside, whilst <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> makes a general purpose distinction to clients
in the usage of connections (between regular queries and zone transfers) this is
not strict and nothing in the DNS protocol prevents using the same connection
for both types of traffic. Hence a server cannot know the intention of any
client that connects to it, it can only inspect the messages it receives on
such a connection and make per query decisions about whether or not to answer
those queries.<a href="#section-a.4-2" class="pilcrow">¶</a></p>
<p id="section-a.4-3">Example policies a XoT server might implement are:<a href="#section-a.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.4-4.1">strict: REFUSE all queries on TLS connections except SOA and authorized XFR requests<a href="#section-a.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-4.2">moderate: REFUSE all queries on TLS connections until one is received that is
signed by a recognized TSIG/SIG(0) key, then answer all queries on the
connection after that<a href="#section-a.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-4.3">complex: apply a heuristic to determine which queries on a TLS connections to REFUSE<a href="#section-a.4-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-4.4">relaxed: answer all non-XoT queries on all TLS connections with the same policy applied to TCP queries<a href="#section-a.4-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-a.4-5">Pros: Allows for flexible behavior by the server that could be changed over time.<a href="#section-a.4-5" class="pilcrow">¶</a></p>
<p id="section-a.4-6">Cons: The server must handle the burden of accepting all TLS connections just
to perform XFRs with a small number of secondaries. Client behavior to REFUSED
response is not clearly defined (see below). Currently, none of the major open
source DNS authoritative implementations offer an option for different response
policies in different transports (but could potentially be implemented using a proxy).<a href="#section-a.4-6" class="pilcrow">¶</a></p>
<div id="sni-based-response-policies">
<section id="section-a.4.1">
          <h3 id="name-sni-based-response-policies">
<a href="#section-a.4.1" class="section-number selfRef">A.4.1. </a><a href="#name-sni-based-response-policies" class="section-name selfRef">SNI based response policies</a>
          </h3>
<p id="section-a.4.1-1">In a similar fashion, XoT servers might use the presence of an SNI in the
client hello to determine which response policy to initially apply to the TLS
connections.<a href="#section-a.4.1-1" class="pilcrow">¶</a></p>
<p id="section-a.4.1-2">Pros: This has to potential to allow a clean distinction between a XoT service
and any future DoT based service for answering recursive queries.<a href="#section-a.4.1-2" class="pilcrow">¶</a></p>
<p id="section-a.4.1-3">Cons: As above.<a href="#section-a.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Willem Toorop</span></div>
<div dir="auto" class="left"><span class="org">NLnet Labs</span></div>
<div dir="auto" class="left"><span class="street-address">Science Park 400</span></div>
<div dir="auto" class="left"><span class="locality">Amsterdam</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:willem@nlnetlabs.nl" class="email">willem@nlnetlabs.nl</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sara Dickinson</span></div>
<div dir="auto" class="left"><span class="org">Sinodun IT</span></div>
<div dir="auto" class="left"><span class="street-address">Magdalen Centre<br>Oxford Science Park</span></div>
<div dir="auto" class="left"><span class="locality">Oxford</span></div>
<div dir="auto" class="left"><span class="postal-code">OX4 4GA</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sara@sinodun.com" class="email">sara@sinodun.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shivan Sahib</span></div>
<div dir="auto" class="left"><span class="org">Salesforce</span></div>
<div dir="auto" class="left">
<span class="locality">Vancouver, BC</span>  </div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ssahib@salesforce.com" class="email">ssahib@salesforce.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pallavi Aras</span></div>
<div dir="auto" class="left"><span class="org">Salesforce</span></div>
<div dir="auto" class="left">
<span class="locality">Herndon, VA</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:paras@salesforce.com" class="email">paras@salesforce.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Allison Mankin</span></div>
<div dir="auto" class="left"><span class="org">Salesforce</span></div>
<div dir="auto" class="left">
<span class="locality">Herndon, VA</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:allison.mankin@gmail.com" class="email">allison.mankin@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
